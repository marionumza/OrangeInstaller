#encoding: utf-8
from OpenOrange import *

ParentFinanceCostReportWindow = SuperClass("FinanceCostReportWindow","Window",__file__)
class FinanceCostReportWindow(ParentFinanceCostReportWindow):

                
    def afterEdit(self, fieldname):
        from cost_analysis import net_present_value2,interest_per_period
        specs = self.getRecord()
        if fieldname == "YearRate":
          specs.Rate = interest_per_period(specs.YearRate,365)
          specs.MonthRate = interest_per_period(specs.YearRate,12)
        elif fieldname == "MonthRate":
          specs.YearRate = -1 + (1.0+specs.MonthRate)**12 
          specs.Rate = interest_per_period(specs.YearRate,365)
        elif fieldname == "Rate":
          specs.YearRate = -1 + (1.0+specs.Rate)**365
          specs.MonthRate = interest_per_period(specs.YearRate,12)



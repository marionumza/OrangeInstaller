#encoding: utf-8
# Abril 2008 - Martin Salcedo
from OpenOrange import *

ParentActivityTypeWindow = SuperClass("ActivityTypeWindow","MasterWindow",__file__)
class ActivityTypeWindow(ParentActivityTypeWindow):

    def buttonClicked(self, buttonname):
        if (buttonname == "showPaletteColor"):
            record = self.getRecord()
            from ActivityTypePaleteColor import ActivityTypePaleteColor
            pcreport = ActivityTypePaleteColor()
            pcreport.MotherWindow = self
            pcreport.BGColor = record.Color
            pcreport.AfterClose = True
            pcreport.getView().resize(200,400)
            pcreport.open(False)

    def afterEdit(self, fieldname):
        if (fieldname == "Color"):
            self.afterShowRecord()
        
    def getPasteWindowName(self,fieldname):
        record = self.getRecord()
        if (fieldname == "Color"):
            from ItemColorPaste import ItemColorPaste
            report = ItemColorPaste()
            report.record = record
            report.fieldname = "Color"
            specs = report.getRecord()
            report.open(False)
            return ""
        return ParentActivityTypeWindow.getPasteWindowName(self,fieldname)
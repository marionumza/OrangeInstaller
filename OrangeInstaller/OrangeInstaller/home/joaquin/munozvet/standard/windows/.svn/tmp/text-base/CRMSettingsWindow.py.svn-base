#encoding: utf-8
from OpenOrange import *

ParentCRMSettingsWindow = SuperClass("CRMSettingsWindow","SettingWindow",__file__)
class CRMSettingsWindow(ParentCRMSettingsWindow):

    def afterEdit(self, fieldname):
        ParentCRMSettingsWindow.afterEdit(self, fieldname)
        record = self.getRecord()
    
    def getPasteWindowName(self,fieldname):
        record = self.getRecord()
        if(fieldname == "Color"):
          from ItemColorPaste import ItemColorPaste
          report = ItemColorPaste()
          report.record = record
          specs = report.getRecord()
          report.open(False)
          return ""
        return ParentCRMSettingsWindow.getPasteWindowName(self,fieldname)

    def filterPasteWindow(self, fieldname):
        if fieldname == "TakenOpportunityState":
            return "{Circuit} = s|%s|" % self.getRecord().OppCircuit
        return ParentCRMSettingsWindow.filterPasteWindow(self, fieldname)

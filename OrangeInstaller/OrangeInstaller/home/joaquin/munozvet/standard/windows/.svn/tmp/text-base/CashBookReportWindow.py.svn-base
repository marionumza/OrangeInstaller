#encoding: utf-8
from OpenOrange import *
from GlobalTools import *

ParentCashBookReportWindow = SuperClass("CashBookReportWindow","ReportWindow",__file__)
class CashBookReportWindow(ParentCashBookReportWindow):

    def afterEdit(self, fname):
        specs = self.getRecord()
        if (fname == "ShiftNr"):
            from CashRegisterEvent import CashRegisterEvent
            cre = CashRegisterEvent.bring(specs.ShiftNr)
            if (cre):
                cre.pasteReportFields(specs)
            pass
        elif (fname == "CashRegister"):
            specs.CashRegisterEvent = None
            specs.User = None
            specs.Office = None
            specs.Computer = None
            specs.Shift = None
            specs.ShiftNr = None

    def filterPasteWindow(self, fname):
        record = self.getRecord()
        if fname == "ShiftNr":
            if record.CashRegister:
                res  = "{Code} = s|%s| " % self.getRecord().CashRegister
                #res += "AND ({StartDate} >= d|%s| AND {EndDate} <= d|%s|)" %(record.FromDate,record.ToDate)
                if (not record.IncludeClosedEvents):
                    res += "AND ({Closed} = 0 OR {Closed} IS NULL)"
                return res
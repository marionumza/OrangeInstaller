#encoding: utf-8
from OpenOrange import *

ParentOwnChequeWindow = SuperClass("OwnChequeWindow","NumerableWindow",__file__)
class OwnChequeWindow(ParentOwnChequeWindow):

    def afterEdit(self, fieldname):
        ParentOwnChequeWindow.afterEdit(self, fieldname)
        record = self.getRecord()
        if (fieldname == "SupCode"):
            record.pasteSupCode()
        elif (fieldname == "Bank"):
            record.pasteBank()
        elif (fieldname == "BankAcc"):
            record.pasteBankAcc()
        elif (fieldname == "ChequeNr"):
            record.pasteChequeNr()
        elif (fieldname == "ExpDate"):
            record.pasteExpDate()
        elif (fieldname == "Receiver"):
            record.pasteReceiver()
        elif (fieldname == "Type"):
            record.pasteType()

    def openTransaction(self):
        from OwnCheque import OwnCheque
        chq = self.getRecord()
        from PaymentWindow import PaymentWindow
        r = chq.getPayment()
        if r:
            wnd = PaymentWindow()
            wnd.setRecord(r)
            wnd.open()
        else:
            from CashOutWindow import CashOutWindow
            r = chq.getCashOut()
            if r:
                wnd = CashOutWindow()
                wnd.setRecord(r)
                wnd.open()
            else:
                from PurchaseInvoiceWindow import PurchaseInvoiceWindow
                r = chq.getPurchaseInvoice()
                if r:
                    wnd = PurchaseInvoiceWindow()
                    wnd.setRecord(r)
                    wnd.open()
                else:
                    message(tr("Record not found!"))

    def openAccreditation(self):
        ochq = self.getRecord()
        from Accreditation import Accreditation
        from AccreditationWindow import AccreditationWindow
        r = ochq.getAccreditation()
        if r:
            wnd = AccreditationWindow()
            wnd.setRecord(r)
            wnd.open()
        else:
           message("El cheque nro %s no tiene acreditacion" % (ochq.SerNr))
           return  

    def openBounce(self):
        from OwnChequeBounceWindow import OwnChequeBounceWindow
        chq = self.getRecord()
        bounce = chq.getOwnChequeBounce()
        if (bounce): 
            wbounce= OwnChequeBounceWindow()
            wbounce.setRecord(bounce)
            wbounce.open()
        else:
            message(tr("Record not found!"))
